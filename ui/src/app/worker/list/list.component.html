<div fxLayout="row wrap" fxLayoutAlign="center center" id="projects-list">
    <div style="padding-top: 20px;" class="container">
        <mat-accordion class="example-headers-align" multi>
            <mat-expansion-panel *ngFor="let server of servers"
                                 [disabled]="!workerMetrics[server.id]">
                <mat-expansion-panel-header>
                    <app-server-node [server]="server" [workerMetric]="workerMetrics[server.id]"></app-server-node>
                </mat-expansion-panel-header>

                <ng-template matExpansionPanelContent>
                    <mat-list>
                        <mat-list-item *ngFor="let terminalMetric of terminalMetrics[server.id] | keyvalue">
                            <!-- TODO: projectId -->
                            <a [routerLink]="['/projects', terminalMetric.value.project_id, 'actions', terminalMetric.value.terminal_name]">
                                {{ terminalMetric.value.project_name }} - {{ terminalMetric.value.action_name }}
                            </a>
                            <span fxFlex></span>
                            <span class="state-info">
                                <mat-icon>memory</mat-icon>
                                <span>{{ terminalMetric.value.memory_percent | number: '1.0-2' }}%</span>
                            </span>
                        </mat-list-item>
                    </mat-list>
                </ng-template>
            </mat-expansion-panel>
        </mat-accordion>

<!--        <mat-tree [dataSource]="dataSource" [treeControl]="treeControl" #tree>-->
<!--            &lt;!&ndash; This is the tree node template for leaf nodes &ndash;&gt;-->
<!--            <mat-tree-node *matTreeNodeDef="let node" matTreeNodePadding>-->
<!--                &lt;!&ndash; use a disabled button to provide padding for tree leaf &ndash;&gt;-->
<!--                <button mat-icon-button disabled></button>-->
<!--                <app-server-node [node]="node" [workerMetric]="workerMetrics[node.server.id]"></app-server-node>-->
<!--            </mat-tree-node>-->
<!--            &lt;!&ndash; This is the tree node template for expandable nodes &ndash;&gt;-->
<!--            <mat-tree-node *matTreeNodeDef="let node; when: hasChild" matTreeNodePadding>-->
<!--                <button mat-icon-button matTreeNodeToggle-->
<!--                        [attr.aria-label]="'Toggle ' + node.name">-->
<!--                    <mat-icon class="mat-icon-rtl-mirror">-->
<!--                        {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}-->
<!--                    </mat-icon>-->
<!--                </button>-->
<!--                <app-server-node [node]="node" [workerMetric]="workerMetrics[node.server.id]"></app-server-node>-->
<!--            </mat-tree-node>-->
<!--        </mat-tree>-->
    </div>
</div>
