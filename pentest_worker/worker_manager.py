import asyncio

import websockets


class WorkerManager:
    def __init__(self):
        pass

    async def connect(self):
        async with websockets.connect("ws://localhost:8700/monitor/") as websocket:
            await websocket.send("Hello world!")
            while True:
                data = await websocket.recv()
                print(data)

    async def run_parallel_connections(self):
        await asyncio.gather(
            self.connect(),
        )

    def start(self):
        asyncio.run(self.run_parallel_connections())
